/*! Angular Feature Flags v1.1.0 Â© 2016 Michael Taranto */
!function(){function e(e,a,t){var n={},r=[],l=function(a){var t=e.defer();return t.resolve(a),t.promise},i=function(e){return a.isPresent(e)},s=function(e){return i(e)?"true"===a.get(e):n[e]},f=function(e){return n[e]},u=function(e){return e.forEach(function(e){n[e.key]=e.active,e.active=s(e.key)}),angular.copy(e,r),r},o=function(e){return e.then(function(e){return u(e.data||e)})},c=function(){return r},g=function(e){return angular.isArray(e)?l(u(e)):o(e)},d=function(e){e.active=!0,a.set(e.key,!0)},v=function(e){e.active=!1,a.set(e.key,!1)},F=function(e){e.active=n[e.key],a.remove(e.key)},m=function(){t&&g(t)};return m(),{set:g,get:c,enable:d,disable:v,reset:F,isOn:s,isOnByDefault:f,isOverridden:i}}angular.module("feature-flags",["release-toggle"]),angular.module("feature-flags").directive("featureFlag",["featureFlags","$interpolate",function(e,a){return{transclude:"element",priority:599,terminal:!0,restrict:"A",$$tlb:!0,compile:function(t,n){var r="featureFlagHide"in n;return t[0].textContent=" featureFlag: "+n.featureFlag+" is "+(r?"on":"off")+" ",function(t,n,l,i,s){var f,u;t.$watch(function(){var n=a(l.featureFlag)(t);return e.isOn(n)},function(e){var a=r?!e:e;a?(u=t.$new(),s(u,function(e){f=e,n.after(f).remove()})):(u&&(u.$destroy(),u=null),f&&(f.after(n).remove(),f=null))})}}}}]),angular.module("feature-flags").directive("featureFlagOverrides",["featureFlags",function(e){return{restrict:"A",link:function(a){a.flags=e.get(),a.isOn=e.isOn,a.isOverridden=e.isOverridden,a.enable=e.enable,a.disable=e.disable,a.reset=e.reset,a.isOnByDefault=e.isOnByDefault},template:'<div class="feature-flags">    <h1>Feature Flags</h1>    <div id="feature-flag--{{flag.key}}" class="feature-flags-flag" ng-repeat="flag in flags">        <div class="feature-flags-name">{{flag.name || flag.key}}</div>        <div id="feature-flag--{{flag.key}}--enable" class="feature-flags-switch" ng-click="enable(flag)" ng-class="{\'active\': isOverridden(flag.key) && isOn(flag.key)}">ON</div>        <div id="feature-flag--{{flag.key}}--disable" class="feature-flags-switch" ng-click="disable(flag)" ng-class="{\'active\': isOverridden(flag.key) && !isOn(flag.key)}">OFF</div>        <div id="feature-flag--{{flag.key}}--reset" class="feature-flags-switch" ng-click="reset(flag)" ng-class="{\'active\': !isOverridden(flag.key)}">DEFAULT ({{isOnByDefault(flag.key) ? \'ON\' : \'OFF\'}})</div>        <div class="feature-flags-desc">{{flag.description}}</div>    </div></div>',replace:!0}}]),angular.module("feature-flags").service("featureFlagOverrides",["$rootElement",function(e){var a,t=e.attr("ng-app"),n="featureFlags."+t+".",r=function(e){return n+e},l=function(e){return 0===e.indexOf(n)},i=function(e,t){localStorage.setItem(r(t+"-"+a),e)},s=function(e){return localStorage.getItem(r(e+"-"+a))},f=function(){return a},u=function(e){a=e},o=function(e){localStorage.removeItem(r(e+"-"+a))};return{isPresent:function(e){return null!==s(e)},get:s,set:function(e,a){angular.isObject(e)?angular.forEach(e,i):i(a,e)},remove:o,reset:function(){var e;for(e in localStorage)l(e)&&localStorage.removeItem(e+"-"+a)},getEnvironment:f,setEnvironment:u}}]),angular.module("feature-flags").provider("featureFlags",function(){var a=[];this.setInitialFlags=function(e){a=e},this.$get=["$q","featureFlagOverrides",function(t,n){return new e(t,n,a)}]}),angular.module("release-toggle",[]).run(["$http","featureFlags","featureFlagOverrides","$location","$rootScope",function(e,a,t,n,r){n.$$search.flags&&(r.showFeaturesPanel=!0),e.get("../data/flags.json").then(function(e){n.absUrl().indexOf("/beta")>-1?(t.setEnvironment("beta"),a.set(e.data.beta,"beta")):(t.setEnvironment("live"),a.set(e.data.live,"live"))})}]).directive("releaseToggle",function(){return{restrict:"A",template:'<div class="feature-panel transformable" ng-class="{\'feature-panel-small\':!showFeatures, \'feature-panel-big\':showFeatures}" ng-show="showFeaturesPanel">    <i class="fa fa-lg fa-close" ng-click="showFeaturesPanel=false"></i>    <div class="heading" ng-click="showFeatures=!showFeatures">Release toggle</div>    <i class="fa fa-angle-down fa-2x" ng-class="{\'fa-angle-down\':!showFeatures,\'fa-angle-up\':showFeatures}" ng-click="showFeatures=!showFeatures"></i>    <div class="feature-modal" ng-show="showFeatures">        <div feature-flag-overrides></div>    </div></div>'}})}();